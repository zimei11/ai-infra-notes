# ai-infra-notesğŸ“–
## å·²æ›´

- AI Infra cppåŸºç¡€
- é‡åŒ–åŸºç¡€

## å¾…æ›´æ–°

- DockeråŸºç¡€
- CudaåŸºç¡€

## å­¦ä¹ è·¯çº¿

å¤§æ¨¡å‹æ¨ç†ä¼˜åŒ–æŠ€æœ¯æ¦‚è¿°å›¾

![image-20250707161136069](https://img.zimei.fun/image-20250707161136069.png)

> *[[2404.14294\] A Survey on Efficient Inference for Large Language Models](https://arxiv.org/abs/2404.14294)*
>
> *Tsinghua Universit*



ä¸ºäº†æŒæ¡å›¾ä¸­æåˆ°çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰é«˜æ•ˆæ¨ç†æŠ€æœ¯ï¼Œç¬”è€…è®¤ä¸ºåº”è¯¥äº†è§£å¦‚ä¸‹æŠ€æœ¯ï¼š

###  1.**è®¡ç®—æœºä½“ç³»ç»“æ„åŸºç¡€**

- CSAPPã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹æ¨èç« èŠ‚
  - ç¬¬ä¸€ç« ï¼šå¯¼è¯»
  - ç¬¬äºŒç« ï¼šä¿¡æ¯è¡¨ç¤ºå¤„ç†
  - ç¬¬ä¸‰ç« ï¼šç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º
  - ç¬¬å…­ç« ï¼šå­˜å‚¨å™¨å±‚æ¬¡ç»“æ„

> æ¶‰åŠçš„çŸ¥è¯†ç‚¹ï¼ˆéƒ¨åˆ†ï¼‰ï¼š
>
> è®¡ç®—
>
> - æµæ°´çº¿ã€å‘é‡åŒ–æ“ä½œã€è¿›åˆ¶è½¬æ¢ã€æµ®ç‚¹æ•°
>
> è®¿å­˜
>
> - æ•°æ®é¢„å–ã€å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„

### 2. **å‰ç½®æ•°å­¦ä¸ç¼–ç¨‹çŸ¥è¯†**

- **çº¿æ€§ä»£æ•°**ï¼šçŸ©é˜µè¿ç®—ã€ç‰¹å¾åˆ†è§£ç­‰åŸºç¡€çŸ¥è¯†ï¼Œå¯¹äºä¼˜åŒ–æ¨¡å‹è®¡ç®—è‡³å…³é‡è¦
- **æ¦‚ç‡ä¸ç»Ÿè®¡**ï¼šç†è§£ **æ¦‚ç‡è®º** å’Œ **ç»Ÿè®¡å­¦**ï¼Œå°¤å…¶æ˜¯åœ¨é‡åŒ–å’ŒçŸ¥è¯†è’¸é¦ä¸­çš„åº”ç”¨
- **ç¼–ç¨‹èƒ½åŠ›**ï¼šç†Ÿæ‚‰ **Python**ã€**C++** ç­‰ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶æŒæ¡ä¸»æµæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚ **PyTorch**ã€**TensorFlow**ï¼‰ï¼Œç†Ÿæ‚‰**Linux**å¼€å‘ç¯å¢ƒ

### 3. **æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ åŸºç¡€**

- **ç¥ç»ç½‘ç»œåŸºç¡€**ï¼šäº†è§£åŸºæœ¬çš„ç¥ç»ç½‘ç»œæ¶æ„ï¼Œéšåæ·±å…¥ **Transformer** æ¨¡å‹çš„åŸç†
- **ä¼˜åŒ–ç®—æ³•**ï¼šç†Ÿæ‚‰å¸¸è§çš„ä¼˜åŒ–ç®—æ³•ï¼Œä»¥åŠå¦‚ä½•åœ¨å¤§è§„æ¨¡æ¨¡å‹ä¸­åº”ç”¨å®ƒä»¬
- **æŸå¤±å‡½æ•°ä¸è¯„ä¼°æŒ‡æ ‡**ï¼šäº†è§£å„ç§æŸå¤±å‡½æ•°ï¼ˆå¦‚äº¤å‰ç†µæŸå¤±ã€MSEï¼‰åŠå…¶åœ¨ä¸åŒä»»åŠ¡ä¸­çš„åº”ç”¨ï¼ŒæŒæ¡ **F1 åˆ†æ•°**ã€**å‡†ç¡®ç‡**ã€**å›°æƒ‘åº¦** ç­‰å¸¸è§è¯„ä¼°æŒ‡æ ‡

### 4. æ¨¡å‹è®­ç»ƒæŠ€æœ¯ï¼ˆäº†è§£ï¼‰

- **æ•°æ®å¤„ç†**ï¼šæ¸…æ´—æ–‡æœ¬ï¼Œå»é™¤å™ªå£°ï¼Œåˆ†è¯å’Œå½’ä¸€åŒ–ç­‰
- **ä¼˜åŒ–ä¸æ­£åˆ™åŒ–**ï¼šå­¦ä¹ ç‡ï¼Œè¿‡æ‹Ÿåˆ
- **é¢„è®­ç»ƒ**ï¼šåœ¨å¤§è§„æ¨¡æ–‡æœ¬ä¸Šè®­ç»ƒåŸºç¡€æ¨¡å‹
- **å¾®è°ƒ**ï¼šåœ¨ç‰¹å®šä»»åŠ¡ä¸Šå¯¹é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œè°ƒæ•´
- **åˆ†å¸ƒå¼è®­ç»ƒ**ï¼šæ•°æ®å¹¶è¡Œç­‰æŠ€æœ¯
- **è¶…å‚æ•°è°ƒæ•´**ï¼šè°ƒå‚

### 5. **é«˜æ•ˆæ¨ç†æŠ€æœ¯**

> å‰é¢æ˜¯å…¬å…±çš„å‰ç½®çŸ¥è¯†ï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥é€‰æ‹©ä¸€ä¸ªå…·ä½“æ–¹å‘æ·±å…¥ç ”ç©¶

- **é«˜æ•ˆç»“æ„è®¾è®¡ï¼ˆEfficient Structure Design, Sec. 5.1ï¼‰**ï¼š
  - **é«˜æ•ˆå‰é¦ˆç½‘ç»œè®¾è®¡ï¼ˆEfficient FFN Designï¼‰**ï¼šé€šè¿‡ä¼˜åŒ–å‰é¦ˆç¥ç»ç½‘ç»œç»“æ„ï¼Œå‡å°‘è®¡ç®—é‡å’Œæ¨¡å‹å‚æ•°
  - **é«˜æ•ˆæ³¨æ„åŠ›æœºåˆ¶è®¾è®¡ï¼ˆEfficient Attention Designï¼‰**ï¼šä¼˜åŒ–æ³¨æ„åŠ›æœºåˆ¶ï¼Œå‡å°‘è®¡ç®—å¤æ‚åº¦ï¼Œå¦‚ **ä½å¤æ‚åº¦æ³¨æ„åŠ›** å’Œ **å¤šæŸ¥è¯¢æ³¨æ„åŠ›**
  - **Transformeræ›¿ä»£ï¼ˆTransformer Alternateï¼‰**ï¼šæ¢ç´¢Transformeræ¶æ„çš„æ›¿ä»£å“ï¼Œä»¥æå‡æ•ˆç‡ã€‚
- **æ¨¡å‹å‹ç¼©ï¼ˆModel Compression, Sec. 5.2ï¼‰**ï¼š
  - **é‡åŒ–ï¼ˆQuantizationï¼‰**ï¼šå°†æ¨¡å‹æƒé‡ä»æµ®åŠ¨ç²¾åº¦è½¬ä¸ºä½ç²¾åº¦ï¼ˆå¦‚8ä½ï¼‰ï¼Œå‡å°‘å†…å­˜å ç”¨å¹¶åŠ é€Ÿæ¨ç†
  - **ç¨€ç–åŒ–ï¼ˆSparsificationï¼‰**ï¼šé€šè¿‡å‰ªæç­‰æ–¹å¼å»é™¤ä¸é‡è¦çš„å‚æ•°ï¼Œå‡å°æ¨¡å‹è§„æ¨¡
  - **çŸ¥è¯†è’¸é¦ï¼ˆKnowledge Distillationï¼‰**ï¼šå°†å¤§æ¨¡å‹çš„çŸ¥è¯†è¿ç§»åˆ°å°æ¨¡å‹ï¼Œæå‡å°æ¨¡å‹çš„æ€§èƒ½å¹¶å‡å°‘è®¡ç®—é‡

- **å›¾ç®—ä¼˜åŒ–ï¼ˆGraph and Operator Optimizationï¼‰**ï¼šä¼˜åŒ–è®¡ç®—å›¾ã€ç®—å­ï¼Œæé«˜è®¡ç®—æ•ˆç‡
- **å†…å­˜ç®¡ç†ï¼ˆMemory Managementï¼‰**ï¼šä¼˜åŒ–å†…å­˜çš„ä½¿ç”¨ï¼Œå‡å°‘å†…å­˜å ç”¨å¹¶åŠ é€Ÿè®¡ç®—è¿‡ç¨‹
- **è°ƒåº¦ï¼ˆSchedulingï¼‰**ï¼šä¼˜åŒ–ä»»åŠ¡è°ƒåº¦ï¼Œç¡®ä¿è®¡ç®—èµ„æºçš„åˆç†åˆ†é…
- **åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆDistributed Systemsï¼‰**ï¼šåˆ©ç”¨å¤šå°æœºå™¨è¿›è¡Œåˆ†å¸ƒå¼æ¨ç†ï¼Œæ‰©å±•è®¡ç®—èƒ½åŠ›

## ç›¸å…³æŠ€æœ¯åšå®¢

| ğŸ“– ç±»åˆ« | ğŸ“– æ ‡é¢˜                                                       | ğŸ“– ä½œè€…                                                       |
| ------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| é‡åŒ–   | [ç›®å‰é’ˆå¯¹å¤§æ¨¡å‹è¿›è¡Œé‡åŒ–çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/627484732/answer/3261671478) | @åƒæœå†»ä¸åæœå†»çš®                                            |
| é‡åŒ–   | [ã€æ¨¡å‹é‡åŒ–-ä¸Šã€‘ä¸€ä¸ªExcelè¯´æ¸…æ¥šæ ¸å¿ƒå…¬å¼_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1CVLAzNEzh/?spm_id_from=333.1387.favlist.content.click&vd_source=ac53754f6533097757863a1d248f5406) | @[è´¹æ›¼å­¦å¾’å†¬ç“œ](https://space.bilibili.com/367678065/?spm_id_from=333.788.upinfo.detail.click) |
| é‡åŒ–   | [[LLMs inference\] quantization é‡åŒ–æ•´ä½“ä»‹ç»ï¼ˆbitsandbytesã€GPTQã€GGUFã€AWQï¼‰_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1FH4y1c73W/?spm_id_from=333.337.search-card.all.click&vd_source=ac53754f6533097757863a1d248f5406) | @[äº”é“å£çº³ä»€](https://space.bilibili.com/59807853/?spm_id_from=333.788.upinfo.detail.click) |
| é‡åŒ–   | [ç›®å‰é’ˆå¯¹å¤§æ¨¡å‹è¿›è¡Œé‡åŒ–çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/627484732/answer/13816157360) | @ä¸å½’ç‰›é¡¿ç®¡çš„ç†ŠçŒ«                                            |
|        | å¾…æ›´æ–° ...                                                   |                                                              |

## Github ä»“åº“

| ğŸ“¦ æ ‡é¢˜                                                       | ğŸ“– ä½œè€…          | ğŸ“– å¤‡æ³¨                                            |
| ------------------------------------------------------------ | --------------- | ------------------------------------------------- |
| [LeetCUDA: Modern CUDA Learn Notes with PyTorch for Beginners](https://github.com/xlite-dev/LeetCUDA?tab=readme-ov-file) | @xlite-dev      | **CUDA**ç¼–ç¨‹å®æˆ˜ä¸ç†è®º                            |
| [llm-action: æœ¬é¡¹ç›®æ—¨åœ¨åˆ†äº«å¤§æ¨¡å‹ç›¸å…³æŠ€æœ¯åŸç†ä»¥åŠå®æˆ˜ç»éªŒï¼ˆå¤§æ¨¡å‹å·¥ç¨‹åŒ–ã€å¤§æ¨¡å‹åº”ç”¨è½åœ°ï¼‰](https://github.com/liguodongiot/llm-action) | @liguodongiot   | å¾®è°ƒï¼Œåˆ†å¸ƒå¼ï¼Œ**æ¨¡å‹å‹ç¼©**                        |
| [AISystem: AISystem ä¸»è¦æ˜¯æŒ‡AIç³»ç»Ÿï¼ŒåŒ…æ‹¬AIèŠ¯ç‰‡ã€AIç¼–è¯‘å™¨ã€AIæ¨ç†å’Œè®­ç»ƒæ¡†æ¶ç­‰AIå…¨æ ˆåº•å±‚æŠ€æœ¯](https://github.com/Infrasys-AI/AISystem) | @Infrasys-AI    | **AIç¼–è¯‘å™¨**ä¸ä½“ç³»ç†è®ºï¼Œ**Bç«™ZOMIé…±**             |
| [leedl-tutorial: ã€Šæå®æ¯…æ·±åº¦å­¦ä¹ æ•™ç¨‹ã€‹ï¼ˆæå®æ¯…è€å¸ˆæ¨èğŸ‘ï¼Œè‹¹æœä¹¦ğŸï¼‰](https://github.com/datawhalechina/leedl-tutorial) | @datawhalechina | **DL**ç†è®º                                        |
| [A curated list of Awesome LLM/VLM Inference Papers with Codes](https://github.com/xlite-dev/Awesome-LLM-Inference) | @xlite-dev      | AI Infraé¢†åŸŸ**è®ºæ–‡**é›†ï¼Œä¸”å¼€æºä»£ç                 |
| [KuiperInfer: æ ¡æ‹›ã€ç§‹æ‹›ã€æ˜¥æ‹›ã€å®ä¹ å¥½é¡¹ç›®ï¼å¸¦ä½ ä»é›¶å®ç°ä¸€ä¸ªé«˜æ€§èƒ½çš„æ·±åº¦å­¦ä¹ æ¨ç†åº“](https://github.com/zjhellofss/KuiperInfer) | @zjhellofss     | CPP**æ‰‹æ“æ¨ç†åº“**å®æˆ˜ï¼Œæœ‰è½¯å¹¿                     |
| [llm_note: LLM notes, including model inference, transformer model structure, and llm framework code analysis notes.](https://github.com/harleyszhang/llm_note?tab=readme-ov-file) | @harleyszhang   | Triton**æ‰‹æ“æ¨ç†æ¡†æ¶**å®æˆ˜ï¼Œå«HPCåšå®¢æ¨èï¼Œæœ‰è½¯å¹¿ |

